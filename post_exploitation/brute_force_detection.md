# üõ°Ô∏è Day 2 - Brute Force Attack Simulation (RDP/SSH)

**üéØ Lab Goal**

Simulate a brute-force attack on a Windows Server 2025 target and verify detection through logs and security tools.

**üß™ Lab Setup**

| Component         | Detail                     |
|-----------------|----------------------------|
| Attacker Machine  | Kali Linux (192.168.1.10)  |
| Target Machine    | Windows Server 2025 (192.168.1.2) |
| Tool Used         | Hydra                      |
| Wordlist          | rockyou.txt                |
| Services Targeted | RDP (3389), SSH (22)       |

**üîç Phase 1: Reconnaissance**

**Command (Kali):**

```bash
nmap -sV 192.168.1.2

Discovered Services:

RDP: Port 3389 open

SSH: Port 22 open

(Based on provided Kali screenshot: kaliscan.jpg)

üö® Phase 2: Brute-Force Simulation

Commands (Kali):

hydra -l administrator -P /usr/share/wordlists/rockyou.txt rdp://192.168.1.2
hydra -l administrator -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.2

Actual Outcome:

The Hydra attempt to brute-force the RDP service on 192.168.1.2:3389 resulted in a connection failure. The tool was unable to establish a connection to the service, as shown in the Kali terminal output. The SSH brute-force command was executed, but its success or failure is not directly confirmed by the provided Kali screenshot.

üõ°Ô∏è Phase 3: Detection & Logging Analysis

üîê Windows Defender

Status: [‚ùå No Alert]

Notes: Windows Defender did not trigger an alert based on the simulated brute-force activity. This is consistent with the Hydra connection failure, as a failed connection attempt may not trigger a brute-force alert.

üìÅ Event Viewer

Security Logs

Event ID 4625 - Failed Logon:

Shows multiple failed logon attempts targeting the administrator account.
Indicates the attempted logon type. For RDP attempts, the Logon Type will be 10 (RemoteInteractive). For SSH (if the target had an SSH server and attempts were made), the Logon Type might vary depending on the SSH implementation.
The Source Network Address field clearly shows the attacker's IP address: 192.168.1.10.

Important Note: The provided Kali screenshot shows a connection failure for the RDP Hydra attempt. The Windows Server Security Logs should be examined for any Event ID 4625 entries related to this failed connection attempt. This may include events indicating a refused connection, even if authentication did not proceed. If no relevant 4625 events are found, this should be explicitly stated.

Sysmon

Event ID 10 - Process Access: While Hydra runs on Kali, this event could potentially log access to processes on the Windows Server that are involved in the authentication process due to the numerous failed login attempts. Reviewing these logs might show processes being accessed repeatedly from the network.

Event ID 1 - Process Creation: A Sysmon Event ID 1 was captured (sysmonEVID1.jpg), showing the creation of C:\Windows\explorer.exe. This event is likely unrelated to the failed RDP brute-force attempt and represents normal Windows system activity (user login or similar) rather than activity directly triggered by the attack.

üñºÔ∏è Screenshots

Description

Screenshot File

Security Log - 4625 Entries

[Screenshot of Windows Server Event Viewer Security Logs showing relevant 4625 entries, if any, related to the attempted RDP connections]

Sysmon Log - Event ID 1

sysmonEVID1.jpg

Windows Defender Alert (if any)

[Screenshot of Windows Defender showing no alert, if applicable]

Important Notes:

The "Security Log - 4625 Entries" screenshot should be from the Windows Server and show any 4625 events related to the attempted RDP connections from Kali.

The "Windows Defender Alert" screenshot should show the Windows Defender interface on the target machine, confirming the absence of an alert.

üìò Notes / Lessons Learned

Brute-force attempts against RDP and SSH services are effectively logged within the Windows Security Event Log under Event ID 4625. The logon type within the event details helps differentiate between different types of login attempts (e.g., RDP is Logon Type 10). However, connection failures may also generate 4625 events.

Windows Defender, in its default configuration, may not always generate alerts for basic brute-force attacks, especially if a connection cannot be established.

Sysmon can provide deeper insights into the system activity triggered by the attack, potentially showing process access related to the failed authentication attempts (Event ID 10). Direct process creation from the remote attacker (Hydra) on the target is less likely to be captured by Sysmon.

The provided Kali screenshot shows that the Hydra tool failed to connect to the RDP service. This highlights the importance of verifying successful attack execution in a lab environment.

Implementing strong password policies, enabling account lockout policies after a certain number of failed attempts, and utilizing intrusion detection/prevention systems (IDS/IPS) are crucial countermeasures against brute-force attacks.

Regularly reviewing security logs is essential for detecting and responding to suspicious activity.

‚úÖ Security+ Objectives Covered

2.1: Compare and contrast common threat actors and motivations (Understanding that brute-force is a common tactic used by various threat actors).

2.2: Analyze potential indicators associated with application attacks (Recognizing numerous failed login attempts as an indicator of a brute-force attack targeting application-level services like RDP and SSH).

2.4: Analyze potential indicators to determine the type of attack (Identifying the pattern of failed logins with specific logon types as a brute-force attack).

üìé References

Hydra tool: https://github.com/vanhauser-thc/thc-hydra
