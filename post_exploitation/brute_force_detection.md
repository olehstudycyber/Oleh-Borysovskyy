# üõ°Ô∏è Day 2 - Brute Force Attack Simulation (RDP/SSH)

**üéØ Lab Goal**

Simulate a brute-force attack on a Windows Server 2025 target and verify detection through logs and security tools.

**üß™ Lab Setup**

| Component         | Detail                     |
|-----------------|----------------------------|
| Attacker Machine  | Kali Linux (192.168.1.10)  |
| Target Machine    | Windows Server 2025 (192.168.1.2) |
| Tool Used         | Hydra                      |
| Wordlist          | rockyou.txt                |
| Services Targeted | RDP (3389), SSH (22)       |

**üîç Phase 1: Reconnaissance**

**Command (Kali):**
```bash
nmap -sV 192.168.1.2
Discovered Services:

RDP: Port 3389 open
SSH: Port 22 open

üö® Phase 2: Brute-Force Simulation

Commands (Kali):

Bash

hydra -l administrator -P /usr/share/wordlists/rockyou.txt rdp://192.168.1.2
hydra -l administrator -P /usr/share/wordlists/rockyou.txt ssh://192.168.1.2
Expected Outcome:

Numerous failed login attempts recorded on the target system for both RDP and SSH services.

üõ°Ô∏è Phase 3: Detection & Logging Analysis

üîê Windows Defender
Status: [‚ùå No Alert]
Notes: Windows Defender did not trigger an alert based on the simulated brute-force activity. This could be due to the default configuration not having specific signatures for basic brute-force patterns or a lack of defined rules for this type of attack.

üìÅ Event Viewer
Security Logs

Event ID 4625 - Failed Logon:
Shows multiple failed logon attempts targeting the administrator account.
Indicates the attempted logon type. For RDP attempts, the Logon Type will be 10 (RemoteInteractive). For SSH (if the target had an SSH server and attempts were made), the Logon Type might vary depending on the SSH implementation.
The Source Network Address field clearly shows the attacker's IP address: 192.168.1.10.

Sysmon 

Event ID 10 - Process Access: While Hydra runs on Kali, this event could potentially log access to processes on the Windows Server that are involved in the authentication process due to the numerous failed login attempts. Reviewing these logs might show processes being accessed repeatedly from the network.
Event ID 1 - Process Creation: Less likely to directly show processes created by Hydra. However, if the failed login attempts triggered any secondary processes on the Windows Server (related to security logging or failed authentication handling), these might be captured.

üñºÔ∏è Screenshots

Description	Screenshot File
Security Log - 4625 Entries	screenshots/day2_eventid_4625.png
Sysmon Log - Event ID 10 (if any)	screenshots/day2_sysmon_event10.png
Windows Defender Alert (if any)	screenshots/day2_defender_alert.png

Export to Sheets
üìò Notes / Lessons Learned

Brute-force attempts against RDP and SSH services are effectively logged within the Windows Security Event Log under Event ID 4625. The logon type within the event details helps differentiate between different types of login attempts (e.g., RDP is Logon Type 10).
Windows Defender, in its default configuration, may not always generate alerts for basic brute-force attacks. Specific rules or more sophisticated behavior monitoring might be required for proactive detection.
Sysmon can provide deeper insights into the system activity triggered by the attack, potentially showing process access related to the failed authentication attempts (Event ID 10). Direct process creation from the remote attacker (Hydra) on the target is less likely to be captured by Sysmon.
Implementing strong password policies, enabling account lockout policies after a certain number of failed attempts, and utilizing intrusion detection/prevention systems (IDS/IPS) are crucial countermeasures against brute-force attacks.
Regularly reviewing security logs is essential for detecting and responding to suspicious activity.

‚úÖ Security+ Objectives Covered

2.1: Compare and contrast common threat actors and motivations (Understanding that brute-force is a common tactic used by various threat actors).
2.2: Analyze potential indicators associated with application attacks (Recognizing numerous failed login attempts as an indicator of a brute-force attack targeting application-level services like RDP and SSH).
2.4: Analyze potential indicators to determine the type of attack (Identifying the pattern of failed logins with specific logon types as a brute-force attack).

üìé References

Hydra tool: https://github.com/vanhauser-thc/thc-hydra
Microsoft Event IDs: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4625
Sysmon Events: https://learn.microsoft.com/en-us/sysinternals/downloads/sysmon
